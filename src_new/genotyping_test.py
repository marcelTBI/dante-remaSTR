from src_new.genotyping import genotype


def test_genotype_function() -> None:
    spanning_observed_counts = [
        15, 15, 15, 15, 16, 15, 16, 15, 16, 16, 16, 15, 15, 15, 15, 15, 15, 15,
        16, 16, 15, 15, 16, 15, 15, 16, 16, 15, 16, 15, 15, 16, 15, 15, 16, 15,
        15, 16, 16, 15, 16, 15, 15, 8, 7, 7, 7, 7
    ]
    spanning_read_lengths = [
        148, 148, 148, 148, 148, 148, 148, 148, 148, 148, 148, 148, 148, 148,
        148, 148, 148, 148, 148, 148, 148, 148, 148, 148, 148, 148, 148, 148,
        148, 148, 148, 148, 148, 148, 148, 148, 148, 148, 148, 148, 148, 148,
        148, 148, 148, 148, 148, 148
    ]
    flanking_observed_counts = [
        1, 1, 1, 1, 1, 1, 1, 2, 2, 3, 3, 3, 3, 3, 3, 3, 4, 5, 5, 5, 5, 5, 6, 6,
        6, 7, 7, 7, 7, 7, 8, 8, 8, 8, 9, 10, 10, 10, 11, 11, 12, 12, 12, 14, 14,
        14, 14, 14, 14, 16, 16, 16, 17, 14, 16, 16, 14, 14, 14, 14, 12, 11, 11,
        10, 8, 10, 9, 9, 8, 7, 7, 6, 6, 5, 4, 4, 3, 3, 2, 2, 2, 2
    ]
    flanking_read_lengths = [
        148, 148, 148, 148, 148, 148, 148, 148, 148, 148, 148, 148, 148, 148,
        148, 148, 148, 148, 148, 148, 148, 148, 148, 148, 148, 148, 148, 148,
        148, 148, 148, 148, 148, 148, 148, 148, 148, 148, 148, 148, 148, 148,
        148, 148, 148, 148, 148, 148, 148, 148, 148, 148, 148, 148, 148, 148,
        148, 148, 148, 148, 148, 148, 148, 148, 148, 148, 148, 148, 148, 148,
        148, 148, 148, 148, 148, 148, 148, 148, 148, 148, 148, 148
    ]
    monoallelic_motif = False

    likelihood_matrix, prediction, confidence = genotype(
        spanning_observed_counts, spanning_read_lengths,
        flanking_observed_counts, flanking_read_lengths,
        monoallelic_motif
    )

    # 2025-06-04
    # print(prediction, confidence)
    # (15, 16)
    # (np.float64(0.9997175515626741), np.float64(0.9999999831193787), np.float64(0.9997175684432957),
    #  np.float64(1.6018865604581832e-31), np.float64(0.00028244775192888), np.float64(1.1162211921206817e-177),
    #  np.float64(1.5081264914144692e-19))
