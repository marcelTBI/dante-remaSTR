<!DOCTYPE html>
<html lang="en">
<head>
    <title>Population report</title>
    <meta charset="UTF-8" />
    <script src="./includes/plotly-2.14.0.min.js"></script>
    <script src="./includes/jquery-3.6.1.min.js"></script>
    <script src="./includes/datatables.min.js"></script>
    <link rel="stylesheet" type="text/css" href="./includes/jquery.dataTables.css">
    <link rel="stylesheet" type="text/css" href="./includes/w3.css">
    <link rel="stylesheet" type="text/css" href="./includes/styles.css">
</head>

<body>
<h1>ALS</h1>
<div>
Sequence:
{{ data["sequence"][0] }}
{% for module in data["sequence"][1:-1] %} <a href="TODO">{{ module }}</a> {% endfor %}
{{ data["sequence"][-1] }}

<table class="tg" id="main_table" width="100%">
    <thead>
        <tr>
            <th rowspan="2">Sample</th>
            <th colspan="{{ data['sequence'][1:-1]|length }}">Nomenclature_1</th>
            <th rowspan="2">Warnings_1</th>
            <th colspan="{{ data['sequence'][1:-1]|length }}">Nomenclature_2</th>
            <th rowspan="2">Warnings_2</th>
        </tr>
        <tr>
            {% for _ in data["sequence"][1:-1] %} <th>part{{ loop.index }}</th> {% endfor %}
            {% for _ in data["sequence"][1:-1] %} <th>part{{ loop.index }}</th> {% endfor %}
        </tr>
    </thead>
    <tbody>
        {% for row in data["main_table"] %}
        <tr>
            <td>{{ row["sample"] }}</td>
            {% for x in row["nomenclature1"] %} <td>{{ x }}</td> {% endfor %}
            <td>{% for x in row["warnings1"] %} {{ x }}<br> {% endfor %}</td>
            {% for x in row["nomenclature2"] %} <td>{{ x }}</td> {% endfor %}
            <td>{% for x in row["warnings2"] %} {{ x }}<br> {% endfor %}</td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<script>
$(document).ready( function() {
    $('#main_table').DataTable({scrollX: true});
} );
</script>


<div id="histogram"></div>
<script>
{
    let title = "Histogram";
    let destination = "histogram"

    // let tickvals = [0, 1, 2];
    // let x = [2, 4, 5];
    // let ticktext = ["tmp", "tmp2", "tmp3"];

    let tickvals = {{ data["main_histogram"]["tickvals"] }};
    let x = {{ data["main_histogram"]["x"] }};
    let ticktext = {{ data["main_histogram"]["ticktext"] }};

    let hist_data = {
        "data":[{
            "x": x,
            "name":"Motif",
            "marker":{"color":"#636EFA"},
            "textfont":{"color":"#636EFA","size":7},
            "type":"bar",
            "orientation": "h",
            "hover":"true"
        }],
        "layout":{
            "title":{"text": title},
            "yaxis":{
                "title":{"text":"Prediction"},
                "tickmode":"array",
                "tickvals": tickvals,
                "ticktext": ticktext,
                "automargin": true
            },
            "xaxis": {"fixedrange":true,"title":{"text":"Count"}},
            "legend": {"x": 0.85, "y": 0.85 },
            "barmode":"stack",
            "hovermode":"y",
            "height": 180 + 30 * x.length
        }
    };

    Plotly.newPlot(destination, hist_data);
}
</script>
</div>

</body>
</html>
